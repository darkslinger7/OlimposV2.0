<%- include('../partials/header') %>
<%- include('../partials/sidebar_cliente') %>
<%- include('../partials/navbar', { titulo: 'Reportes y Solicitudes', icono: 'fa-concierge-bell', usuario }) %>

<div class="main-content">
  <main class="content">

    <div class="agg">
        <h3 style="color: #c0392b; margin-bottom: 15px;"><i class="fas fa-bullhorn"></i> Reportar Incidencia</h3>
        <form method="POST" action="/cliente/avisos/crear" class="login-form" style="border-top-color: #c0392b;">
            <div class="form-group" style="grid-column: 1 / -1;">
                <label>Asunto</label>
                <select name="titulo" required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px;">
                    <option value="Limpieza">Solicitar Limpieza</option>
                    <option value="Mantenimiento">Falla / Mantenimiento</option>
                    <option value="Ruidos">Ruidos Molestos</option>
                    <option value="Room Service">Servicio a la Habitaci√≥n</option>
                    <option value="Otro">Otro</option>
                </select>
            </div>
            <div class="form-group" style="grid-column: 1 / -1;">
                <label>Detalles</label>
                <textarea name="mensaje" rows="3" placeholder="Describa su solicitud..." required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px;"></textarea>
            </div>
            <button type="submit" style="background: #c0392b; width: 100%;">Enviar Reporte</button>
        </form>
    </div>

    <section class="crud">
        <h3 style="color: #34495e; border-bottom: 2px solid #eee;">Mis Reportes Enviados</h3>
        <table>
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Asunto</th>
                    <th>Mensaje</th>
                    <th>Estado</th>
                </tr>
            </thead>
            <tbody>
                <% if (avisos.length > 0) { %>
                    <% avisos.forEach(a => { %>
                        <tr>
                            <td><%= new Date(a.fecha).toLocaleDateString() %></td>
                            <td><strong><%= a.titulo %></strong></td>
                            <td><%= a.mensaje %></td>
                            <td><span class="badge" style="background: #95a5a6;">Enviado</span></td>
                        </tr>
                    <% }) %>
                <% } else { %>
                    <tr><td colspan="4" style="text-align: center;">No has realizado reportes.</td></tr>
                <% } %>
            </tbody>
        </table>
    </section>

  </main>
<%- include('../partials/footer') %>
</div>